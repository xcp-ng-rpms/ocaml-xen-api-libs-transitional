From 1a75c5106a8c1f7b4177b97776d9c8f4975d4b07 Mon Sep 17 00:00:00 2001
From: Rob Hoes <rob.hoes@citrix.com>
Date: Wed, 17 Aug 2022 13:51:49 +0000
Subject: [PATCH 1/9] Use ocaml-format

The definition is copied from xen-api#1.249-lcm.

Signed-off-by: Rob Hoes <rob.hoes@citrix.com>
---
 resources/.ocamlformat => .ocamlformat | 4 +---
 Makefile                               | 5 +++--
 dune-project                           | 3 ++-
 3 files changed, 6 insertions(+), 6 deletions(-)
 rename resources/.ocamlformat => .ocamlformat (80%)

diff --git a/resources/.ocamlformat b/.ocamlformat
similarity index 80%
rename from resources/.ocamlformat
rename to .ocamlformat
index d2f9d0651..f86522707 100644
--- a/resources/.ocamlformat
+++ b/.ocamlformat
@@ -1,5 +1,4 @@
 profile=ocamlformat
-version=0.14.1
 indicate-multiline-delimiters=closing-on-separate-line
 if-then-else=fit-or-vertical
 dock-collection-brackets=true
@@ -7,5 +6,4 @@ break-struct=natural
 break-separators=before
 break-infix=fit-or-vertical
 break-infix-before-func=false
-wrap-comments=true
-parse-docstrings=true
+sequence-blank-line=preserve-one
diff --git a/Makefile b/Makefile
index a0dcda911..0fc4cc0f2 100644
--- a/Makefile
+++ b/Makefile
@@ -22,5 +22,6 @@ test:
 doc:
 	dune build @doc --profile=$(PROFILE)
 
-reindent:
-	git ls-files '*.ml' '*.mli' | xargs ocp-indent --inplace
+format:
+	dune build @fmt --auto-promote
+
diff --git a/dune-project b/dune-project
index 42bd9c40e..c14d03c1f 100644
--- a/dune-project
+++ b/dune-project
@@ -1,2 +1,3 @@
-(lang dune 1.9)
+(lang dune 1.11)
 (allow_approximate_merlin)
+(using fmt 1.2 (enabled_for ocaml))
-- 
2.31.1

